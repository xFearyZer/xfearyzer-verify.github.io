<!DOCTYPE html>
<html>
<head>
    <title>Verification Portal</title>
    <script>
        // Xử lý khi trang load
        function init() {
            const params = new URLSearchParams(location.search);
            
            // Bước 1: Hiển thị CAPTCHA giả lập
            if (!params.has('verified')) {
                showCaptcha();
                return;
            }
            
            // Bước 2: Tạo token và chuyển hướng
            const token = generateToken();
            redirectToKeySystem(token);
        }

        function showCaptcha() {
            document.body.innerHTML = `
                <div class="captcha-container">
                    <h2>Hoàn thành xác minh</h2>
                    <div class="captcha-box">Nhập mã 123456</div>
                    <input type="text" id="captcha-input">
                    <button onclick="verifyCaptcha()">Xác nhận</button>
                </div>
            `;
        }

        function verifyCaptcha() {
            const input = document.getElementById('captcha-input').value;
            if (input === '123456') { // CAPTCHA đơn giản
                const newUrl = new URL(location.href);
                newUrl.searchParams.set('verified', 'true');
                location.href = newUrl.toString();
            } else {
                alert('Mã xác minh không đúng!');
            }
        }

        function generateToken() {
            // Tạo token ngẫu nhiên + mã hóa đơn giản
            const token = btoa(Date.now() + '|' + Math.random().toString(36).substr(2));
            localStorage.setItem('yt_verify_token', token);
            return token;
        }

        function redirectToKeySystem(token) {
            const keyUrl = new URL('https://xfearyzer.github.io/keysystem/');
            keyUrl.searchParams.set('vt', token);
            location.href = keyUrl.toString();
        }
    </script>
</head>
<body onload="init()">
</body>
</html>
